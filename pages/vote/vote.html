<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>VoteCraft - Explore Issues & Representatives</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <div class="vote-widget">
        <div class="vote-layout">

            <!-- LEFT PANEL: Search + Reps -->
            <aside class="left-panel">
                <div class="search-section">
                    <input type="text" id="address-input"
                           placeholder="State or zip"
                           autocomplete="street-address">
                    <button id="lookup-btn" class="btn-search">Search</button>
                </div>

                <div class="panel-toggle">
                    <button id="toggle-reps" class="toggle-btn active">REPRESENTATIVES</button>
                    <button id="toggle-issues" class="toggle-btn">ISSUES</button>
                </div>

                <!-- Representatives List -->
                <div id="reps-panel" class="panel-content">
                    <div id="federal-section" class="rep-section">
                        <h3 class="rep-section-title">Federal Legislators</h3>
                        <div id="federal-list" class="rep-list"></div>
                    </div>
                    <div id="local-section" class="rep-section">
                        <h3 class="rep-section-title">Local Legislators</h3>
                        <div id="local-list" class="rep-list"></div>
                    </div>
                    <div id="state-section" class="rep-section">
                        <h3 class="rep-section-title">State Legislators</h3>
                        <div id="state-list" class="rep-list"></div>
                    </div>
                </div>

                <!-- Issues List (mobile/toggle view) -->
                <div id="issues-panel" class="panel-content" style="display:none;">
                    <div id="issues-sidebar-list" class="issues-sidebar-list"></div>
                </div>
            </aside>

            <!-- Panel divider with expand controls -->
            <div class="panel-divider" id="panel-divider">
                <button class="divider-btn divider-btn-left" id="expand-left-btn" title="Expand sidebar">&#x25C0;</button>
                <button class="divider-btn divider-btn-right" id="expand-right-btn" title="Expand content">&#x25B6;</button>
            </div>
            <button class="divider-btn-restore" id="restore-btn" title="Restore split view">&#x25BC;</button>

            <!-- RIGHT PANEL: Content area -->
            <main class="right-panel">
                <!-- Loading overlay -->
                <div id="loading-screen" class="loading-overlay">
                    <div class="loader"></div>
                    <p>Loading...</p>
                </div>

                <!-- Error message -->
                <div id="error-screen" class="error-inline" style="display:none;">
                    <div class="error-message">
                        <span class="error-icon">!</span>
                        <p id="error-text"></p>
                    </div>
                </div>

                <!-- VIEW 1: Issues Grid -->
                <div id="issues-grid-view" class="view-container">
                    <h1 class="right-panel-title">Explore Issues</h1>
                    <p class="right-panel-subtitle">Select an issue to learn more and see how these representatives align</p>
                    <div id="issues-grid" class="issues-grid"></div>
                </div>

                <!-- Back button (positioned absolutely in right panel) -->
                <button id="back-btn" class="btn-back" style="display:none;">BACK</button>

                <!-- VIEW 2: Issue Detail -->
                <div id="issue-detail-view" class="view-container" style="display:none;">
                    <h1 id="issue-title" class="issue-detail-title"></h1>

                    <div class="issue-detail-layout">
                        <div class="issue-col">
                            <div id="issue-hero" class="issue-hero">
                                <img id="issue-hero-img" src="" alt="">
                            </div>
                            <div class="issue-desc-box">
                                <p id="issue-description" class="issue-detail-desc"></p>
                                <button id="learn-more-btn" class="btn-learn-more">Learn More</button>
                            </div>
                        </div>

                        <div class="issue-col">
                            <div id="rep-alignment-card" class="rep-alignment-card" style="display:none;">
                                <div id="rep-card-photo" class="rep-card-photo"></div>
                                <h3 id="rep-card-name" class="rep-card-name"></h3>
                                <div id="rep-alignment-score" class="alignment-score"></div>
                                <div id="rep-alignment-bills" class="alignment-bills"></div>
                            </div>
                        </div>

                        <div class="issue-col">
                            <div id="issue-map-card" class="issue-map-card">
                                <div id="issue-map"></div>
                            </div>
                            <div id="top-supporters-widget" class="top-supporters-widget" style="display:none;">
                                <h4 class="top-supporters-title">Top Supporters</h4>
                                <div id="top-supporters-list" class="top-supporters-list"></div>
                                <button id="view-all-supporters-btn" class="btn-view-all-supporters">View All Supporters</button>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Donate bar (inside right panel) -->
                <div id="nonprofits-section" class="nonprofits-section" style="display:none;">
                    <h2 class="nonprofits-headline">CRAFT YOUR VOTE</h2>
                    <p class="nonprofits-subtext">Vote with your dollar by donating and unlock Emporium access. No spam. No text blasts. Our promise.</p>
                    <div id="nonprofits-grid" class="nonprofits-grid"></div>
                </div>

                <!-- Learn More Modal -->
                <div id="learn-more-modal" class="learn-more-modal" style="display:none;">
                    <div class="learn-more-modal-inner">
                        <button id="learn-more-close" class="learn-more-close">&#x2715;</button>
                        <iframe id="learn-more-iframe" class="learn-more-iframe" src="" title="Learn More"></iframe>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <link rel="stylesheet" href="css/vote.css?v=110">
    <script src="js/issues-data.js?v=85"></script>
    <script src="js/civic-api.js?v=85"></script>
    <script src="js/vote-app.js?v=92"></script>
</body>
</html>
